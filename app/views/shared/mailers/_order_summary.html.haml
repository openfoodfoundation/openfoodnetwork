%table.order-summary{:width => "100%"}
  %thead
    %tr
      %th{align: "left"}
        %h4
          = t('.item')
      %th{align: "left"}
        %h4
          = t('.sku')
      %th{align: "right"}
        %h4
          = t('.quantity')
      %th{align: "right"}
        %h4
          = t('.price')
  %tbody
    - @order.line_items.sorted_by_name_and_unit_value.each do |item|
      %tr
        %td
          = render 'spree/shared/line_item_name', line_item: item
          %br
          %small
            %em= item.variant.supplier.name
        %td
          - if item.variant.sku.blank?
            \-
          - else
            = item.variant.sku
        %td{align: "right"}
          - if @changes && @changes[item.id].present?
            %del.quantity_was= @changes[item.id]
          = item.quantity
          -# Report changes made to subscriptions

        %td{align: "right"}
          = item.display_amount_with_adjustments
  %tfoot
    %tr
      %td{align: "right", colspan: "3"}
        = t('.subtotal')
      %td{align: "right"}
        = display_checkout_subtotal(@order)
    - checkout_adjustments_for(@order, exclude: [:line_item]).reverse_each do |adjustment|
      %tr
        %td{align: "right", colspan: "3"}
          = "#{adjustment.label}:"
        %td{align: "right"}
          = adjustment.display_amount
    %tr
      %td{align: "right", colspan: "3"}
        %strong
          = t('.total')
      %td{align: "right"}
        %strong= @order.display_total

    - if @order.total_tax > 0
      %tr
        %td{align: "right", colspan: "3"}
          = t('.includes_tax')
        %td{align: "right"}
          = display_checkout_tax_total(@order)
