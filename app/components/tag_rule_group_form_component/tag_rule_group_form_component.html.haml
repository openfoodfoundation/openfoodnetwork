%div{ id: form_id, "data-controller": "tag-rule-group-form" }
  - rule_index = customer_rule_index
  .customer_tag
    .header
      %table
        %colgroup
          %col{width: '35%'}
          %col{width: '65%'}
        %tr
          %td
            %h5
              = t('components.tag_rule_group_form.for_customers_tagged')
          %td
            = render(TagListInputComponent.new(name: tag_list_input_name,
              tags: group[:tags],
              only_one: true,
              hidden_field_data_options: { "data-action": "input->tag-rule-group-form#updatePreferredCustomerTag", "data-tag-rule-group-form-target": "customerTag" }))
    %div{ id: customer_tag_rule_div_id }
      - if group[:rules].empty?
        .no_rules
          = t('components.tag_rule_group_form.no_rules_yet')
      - else
        - group[:rules].each do |rule|
          - rule_index += 1
          = render(TagRuleFormComponent.new(rule: rule,
            index: rule_index,
            customer_tags: group[:tags],
            hidden_field_customer_tag_options: { "data-tag-rule-group-form-target": "ruleCustomerTag" }))

    %hr
    .add_rule.text-center
      %input.button{ type: 'button', value: t('components.tag_rule_group_form.add_new_rule'), "data-controller": "modal-link", "data-action": "click->modal-link#open", "data-modal-link-target-value": "tag_rule_add_new_rule_#{index}" }

  = render AddTagRuleModalComponent.new(id: "tag_rule_add_new_rule_#{index}",
    tag_rule_types: tag_rule_types,
    current_index: (rule_index + 1),
    div_id: customer_tag_rule_div_id,
    customer_tag: group[:tags],
    hidden_field_customer_tag_options: { "data-tag-rule-group-form-target": "ruleCustomerTag" })
